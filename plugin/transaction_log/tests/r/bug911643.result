CREATE TABLE t1 (
pk INT NOT NULL AUTO_INCREMENT,
col_int1 INT,
col_int2 INT,
col_int_not_null INT NOT NULL,
PRIMARY KEY (pk));
INSERT INTO t1 (col_int1, col_int2, col_int_not_null) VALUES (1,1,1);
INSERT INTO t1 (col_int1, col_int2, col_int_not_null) VALUES (NULL,1,1);
INSERT INTO t1 (col_int1, col_int2, col_int_not_null) VALUES (2,1,3);
SET GLOBAL transaction_log_truncate_debug= true;
BEGIN;
UPDATE t1 SET col_int_not_null = col_int1 WHERE col_int2 = 1;
ERROR 23000: Column 'col_int_not_null' cannot be null
INSERT INTO t1 (col_int1, col_int2, col_int_not_null) VALUES (5,5,5);
COMMIT;

We should have a Transaction with a single insert Statement
SELECT PRINT_TRANSACTION_MESSAGE('test/transaction.log',(select max(entry_offset) from DATA_DICTIONARY.TRANSACTION_LOG_TRANSACTIONS));
PRINT_TRANSACTION_MESSAGE('test/transaction.log',(select max(entry_offset) from DATA_DICTIONARY.TRANSACTION_LOG_TRANSACTIONS))
transaction_context {
  server_id: 1
  TRANSACTION_ID
  START_TIMESTAMP
  END_TIMESTAMP
}
statement {
  type: INSERT
  START_TIMESTAMP
  END_TIMESTAMP
  insert_header {
    table_metadata {
      schema_name: "test"
      table_name: "t1"
    }
    field_metadata {
      type: INTEGER
      name: "pk"
    }
    field_metadata {
      type: INTEGER
      name: "col_int1"
    }
    field_metadata {
      type: INTEGER
      name: "col_int2"
    }
    field_metadata {
      type: INTEGER
      name: "col_int_not_null"
    }
  }
  insert_data {
    segment_id: 1
    end_segment: true
    record {
      insert_value: "4"
      insert_value: "5"
      insert_value: "5"
      insert_value: "5"
      is_null: false
      is_null: false
      is_null: false
      is_null: false
    }
  }
}
segment_id: 1
end_segment: true

DROP TABLE t1;
SET GLOBAL transaction_log_truncate_debug= true;
