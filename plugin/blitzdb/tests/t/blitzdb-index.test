# Test Routine for Indexing in BlitzDB

--disable_warnings
drop table if exists t1, t2;
--enable_warnings

create table t1(id int primary key, a int, b int) engine = blitzdb;
insert into t1 values (1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4);
insert into t1 values (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8);

# Test Duplicate Primary Key Insertions
--error 1062
insert into t1 values (1, 0, 0);
--error 1062
insert into t1 values (2, 0, 0);
--error 1062
insert into t1 values (3, 0, 0);
--error 1062
insert into t1 values (4, 0, 0);

# Test Needle in a Haystack query
select * from t1 where id = 2;
select * from t1 where id = 4;
select * from t1 where id = 6;

# Test Primary Key based Deletion
delete from t1 where id = 5;
delete from t1 where id = 6;
delete from t1 where id = 7;
delete from t1 where id = 8;

select * from t1;

drop table t1;
