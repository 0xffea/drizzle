drop table if exists t1, t2;
create table t1 (id int primary key, a int, b int) engine = blitzdb;
select * from t1;
id	a	b
insert into t1 values (1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4);
insert into t1 values (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8);
insert into t1 values (1, 0, 0);
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
insert into t1 values (2, 0, 0);
ERROR 23000: Duplicate entry '2' for key 'PRIMARY'
insert into t1 values (3, 0, 0);
ERROR 23000: Duplicate entry '3' for key 'PRIMARY'
insert into t1 values (4, 0, 0);
ERROR 23000: Duplicate entry '4' for key 'PRIMARY'
select * from t1 where id = 2;
id	a	b
2	2	2
select * from t1 where id = 4;
id	a	b
4	4	4
select * from t1 where id = 6;
id	a	b
6	6	6
select count (*) from t1;
count (*)
8
delete from t1 where id = 5;
select count (*) from t1;
count (*)
7
delete from t1 where id = 6;
select count (*) from t1;
count (*)
6
delete from t1 where id = 7;
select count (*) from t1;
count (*)
5
delete from t1 where id = 8;
select count (*) from t1;
count (*)
4
select count (id) from t1;
count (id)
4
select count (a) from t1;
count (a)
4
select count (b) from t1;
count (b)
4
select * from t1;
id	a	b
1	1	1
2	2	2
3	3	3
4	4	4
delete from t1;
select count (*) from t1;
count (*)
0
drop table t1;
create table t1 (id int primary key auto_increment, num int) engine = blitzdb;
insert into t1 (num) values (1);
select * from t1;
id	num
1	1
insert into t1 (num) values (1);
insert into t1 (num) values (1);
insert into t1 (num) values (1);
select count(*) from t1;
count(*)
4
flush table t1;
select count(*) from t1;
count(*)
4
insert into t1 (num) values (1);
insert into t1 (num) values (1);
insert into t1 (num) values (1);
insert into t1 (num) values (1);
select count(*) from t1;
count(*)
8
select count(num) from t1;
count(num)
8
select * from t1;
id	num
1	1
2	1
3	1
4	1
5	1
6	1
7	1
8	1
drop table t1;
create table t1 (id int primary key auto_increment) engine = blitzdb;
insert into t1 values ();
insert into t1 values ();
insert into t1 values ();
insert into t1 values ();
select count(*) from t1;
count(*)
4
delete from t1 where id = 1;
delete from t1 where id = 2;
select count(*) from t1;
count(*)
2
insert into t1 values ();
insert into t1 values ();
select count(*) from t1;
count(*)
4
drop table t1;
create table t1 (id varchar(64) primary key, country varchar(64)) engine = blitzdb;
insert into t1 values ('amsterdam', 'netherlands');
insert into t1 values ('budapest', 'hungary');
insert into t1 values ('copenhagen', 'denmark');
insert into t1 values ('dublin', 'ireland');
insert into t1 values ('edinburgh', 'scotland');
insert into t1 values ('fukuoka', 'japan');
insert into t1 values ('geneva', 'switzerland');
select * from t1;
id	country
amsterdam	netherlands
budapest	hungary
copenhagen	denmark
dublin	ireland
edinburgh	scotland
fukuoka	japan
geneva	switzerland
select country from t1 where id = 'dublin';
country
ireland
select country from t1 where id = 'geneva';
country
switzerland
select country from t1 where id = 'amsterdam';
country
netherlands
select country from t1 where id = 'non existent key';
country
select country from t1 where id = 'edinburgh';
country
scotland
select country from t1 where id = 'copenhagen';
country
denmark
select country from t1 where id = 'fukuoka';
country
japan
select country from t1 where id = 'budapest';
country
hungary
select count (id) from t1;
count (id)
7
delete from t1 where id = 'geneva';
delete from t1 where id = 'fukuoka';
select count (id) from t1;
count (id)
5
select count (*) from t1;
count (*)
5
select * from t1;
id	country
amsterdam	netherlands
budapest	hungary
copenhagen	denmark
dublin	ireland
edinburgh	scotland
drop table t1;
create table t1 (a varchar(10) primary key, b int) engine = blitzdb;
insert into t1 values ('aaa', 1), ('bbb', 2), ('ccc', 3), ('ddd', 4);
insert into t1 values ('eee', 5), ('fff', 6), ('ggg', 7), ('hhh', 8);
select * from t1 where a = 'aaa';
a	b
aaa	1
select * from t1 where a = 'bbb';
a	b
bbb	2
select * from t1 where a = 'ccc';
a	b
ccc	3
select * from t1 where a = 'ddd';
a	b
ddd	4
select * from t1;
a	b
aaa	1
bbb	2
ccc	3
ddd	4
eee	5
fff	6
ggg	7
hhh	8
delete from t1 where a = 'ggg';
delete from t1 where a = 'hhh';
select * from t1;
a	b
aaa	1
bbb	2
ccc	3
ddd	4
eee	5
fff	6
drop table t1;
create table t1 (a date primary key, b int, c varchar(32)) engine = blitzdb;
insert into t1 values ('1984-09-22', 22, 'twenty two');
insert into t1 values ('1984-09-23', 23, 'twenty three');
insert into t1 values ('1984-09-24', 24, 'twenty four');
insert into t1 values ('1984-09-25', 23, 'twenty five');
select * from t1;
a	b	c
1984-09-22	22	twenty two
1984-09-23	23	twenty three
1984-09-24	24	twenty four
1984-09-25	23	twenty five
explain select * from t1 where a = '1984-09-22';
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	const	PRIMARY	PRIMARY	3	const	1	
select * from t1 where a = '1984-09-22';
a	b	c
1984-09-22	22	twenty two
select * from t1 where a = '1984-09-23';
a	b	c
1984-09-23	23	twenty three
select * from t1 where a = '1984-09-24';
a	b	c
1984-09-24	24	twenty four
select * from t1 where a = '1984-09-25';
a	b	c
1984-09-25	23	twenty five
drop table t1;
create table t1 (a int primary key) engine = blitzdb;
insert into t1 values (1), (2), (3), (4), (5), (6);
explain select * from t1 order by a desc;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	6	Using index
select * from t1;
a
1
2
3
4
5
6
explain select * from t1 order by a desc;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	6	Using index
select * from t1 order by a desc;
a
6
5
4
3
2
1
delete from t1;
insert into t1 values (6), (1), (5), (3), (2), (4);
explain select * from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	6	Using index
select * from t1;
a
1
2
3
4
5
6
explain select * from t1 order by a desc;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	6	Using index
select * from t1 order by a desc;
a
6
5
4
3
2
1
delete from t1;
insert into t1 values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10);
insert into t1 values (11),(12),(13),(14),(15),(16),(17),(18),(19),(20);
insert into t1 values (21),(22),(23),(24),(25),(26),(27),(28),(29),(30);
insert into t1 values (31),(32),(33),(34),(35),(36),(37),(38),(39),(40);
insert into t1 values (41),(42),(43),(44),(45),(46),(47),(48),(49),(50);
explain select * from t1 where a > 20 and a < 30;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	PRIMARY	PRIMARY	4	NULL	50	Using where; Using index
select * from t1 where a > 20 and a < 38;
a
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
explain select * from t1 where a > 20 and a < 30;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	PRIMARY	PRIMARY	4	NULL	50	Using where; Using index
select * from t1 where a > 20 and a < 20;
a
explain select max(a) from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	NULL	NULL	NULL	NULL	NULL	NULL	NULL	Select tables optimized away
select max(a) from t1;
max(a)
50
explain select max(a) from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	NULL	NULL	NULL	NULL	NULL	NULL	NULL	Select tables optimized away
select min(a) from t1;
min(a)
1
explain select sum(a) from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	50	Using index
select sum(a) from t1;
sum(a)
1275
explain select * from t1 where a in (10, 20, 30, 40, 50);
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	range	PRIMARY	PRIMARY	4	NULL	5	Using where; Using index
select * from t1 where a in (10, 20, 30, 40, 50);
a
10
20
30
40
50
drop table t1;
create table t1 (a bigint primary key) engine = blitzdb;
insert into t1 values (10), (20), (30), (40), (50), (60);
explain select * from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	8	NULL	6	Using index
select * from t1;
a
10
20
30
40
50
60
select * from t1 order by a desc;
a
60
50
40
30
20
10
delete from t1;
insert into t1 values (60), (10), (50), (30), (20), (40);
select * from t1;
a
10
20
30
40
50
60
select * from t1 order by a desc;
a
60
50
40
30
20
10
drop table t1;
create table t1 (a varchar(10) primary key) engine = blitzdb;
insert into t1 values ('a'), ('b'), ('c'), ('d'), ('e');
select * from t1;
a
a
b
c
d
e
explain select * from t1 order by a desc;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	42	NULL	5	Using index
select * from t1 order by a desc;
a
e
d
c
b
a
delete from t1;
insert into t1 values ('c'), ('a'), ('e'), ('b'), ('d');
select * from t1;
a
a
b
c
d
e
delete from t1;
insert into t1 values ('う'), ('お'), ('い'), ('あ'), ('え');
insert into t1 values ('こ'), ('け'), ('か'), ('く'), ('き');
explain select * from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	42	NULL	10	Using index
select * from t1;
a
あ
い
う
え
お
か
き
く
け
こ
explain select * from t1 order by a desc;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	42	NULL	10	Using index
select * from t1 order by a desc;
a
こ
け
く
き
か
お
え
う
い
あ
drop table t1;
create table t1 (a varchar(255) primary key) engine = blitzdb;
insert into t1 values ('a'), ('b'), ('c'), ('d'), ('e');
explain select * from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	1022	NULL	5	Using index
select * from t1;
a
a
b
c
d
e
select * from t1 order by a desc;
a
e
d
c
b
a
delete from t1;
insert into t1 values ('c'), ('a'), ('e'), ('b'), ('d');
select * from t1;
a
a
b
c
d
e
delete from t1;
drop table t1;
create table t1 (a int, unique index(a)) engine = blitzdb;
insert into t1 values (1), (2);
insert into t1 values (1);
ERROR 23000: Duplicate entry '1' for key 'a'
insert into t1 values (2);
ERROR 23000: Duplicate entry '2' for key 'a'
insert into t1 values (NULL);
insert into t1 values (3);
insert into t1 values (4);
select * from t1;
a
NULL
1
2
3
4
select * from t1 where a = 1;
a
1
select * from t1 where a = 2;
a
2
select * from t1 where a = 3;
a
3
select * from t1 where a = 4;
a
4
select * from t1 where a is NULL;
a
NULL
drop table t1;
create table t1 (a varchar(32), unique index(a)) engine = blitzdb;
insert into t1 values ('a'), ('b'), ('c');
insert into t1 values ('a');
ERROR 23000: Duplicate entry 'a' for key 'a'
insert into t1 values ('b');
ERROR 23000: Duplicate entry 'b' for key 'a'
insert into t1 values ('c');
ERROR 23000: Duplicate entry 'c' for key 'a'
insert into t1 values ('f'), ('e'), ('d');
select * from t1;
a
a
b
c
d
e
f
explain select * from t1 where a = 'a';
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	const	a	a	131	const	1	Using index
select * from t1 where a = 'a';
a
a
select * from t1 where a = 'b';
a
b
select * from t1 where a = 'c';
a
c
select * from t1 where a = 'd';
a
d
select * from t1 where a = 'e';
a
e
select * from t1 where a = 'f';
a
f
drop table t1;
create table t1 (a int, index(a)) engine = blitzdb;
insert into t1 values (1), (2), (3), (4);
insert into t1 values (1), (2), (3), (4);
select * from t1;
a
1
1
2
2
3
3
4
4
insert into t1 values (NULL), (NULL);
insert into t1 values (NULL), (NULL);
select * from t1;
a
NULL
NULL
NULL
NULL
1
1
2
2
3
3
4
4
select count(*) from t1 where a is NULL;
count(*)
4
select * from t1 where a is NULL;
a
NULL
NULL
NULL
NULL
select * from t1 where a is not NULL;
a
1
1
2
2
3
3
4
4
explain select * from t1 where a = 1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ref	a	a	5	const	10	Using index
select * from t1 where a = 1;
a
1
1
select * from t1 where a = 2;
a
2
2
select * from t1 where a = 3;
a
3
3
select * from t1 where a = 4;
a
4
4
drop table t1;
