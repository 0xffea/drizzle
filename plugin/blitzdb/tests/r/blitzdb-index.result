drop table if exists t1, t2;
create table t1 (id int primary key, a int, b int) engine = blitzdb;
insert into t1 values (1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4);
insert into t1 values (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8);
insert into t1 values (1, 0, 0);
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
insert into t1 values (2, 0, 0);
ERROR 23000: Duplicate entry '2' for key 'PRIMARY'
insert into t1 values (3, 0, 0);
ERROR 23000: Duplicate entry '3' for key 'PRIMARY'
insert into t1 values (4, 0, 0);
ERROR 23000: Duplicate entry '4' for key 'PRIMARY'
select * from t1 where id = 2;
id	a	b
2	2	2
select * from t1 where id = 4;
id	a	b
4	4	4
select * from t1 where id = 6;
id	a	b
6	6	6
select count (*) from t1;
count (*)
8
delete from t1 where id = 5;
select count (*) from t1;
count (*)
7
delete from t1 where id = 6;
select count (*) from t1;
count (*)
6
delete from t1 where id = 7;
select count (*) from t1;
count (*)
5
delete from t1 where id = 8;
select count (*) from t1;
count (*)
4
select count (id) from t1;
count (id)
4
select count (a) from t1;
count (a)
4
select count (b) from t1;
count (b)
4
select * from t1;
id	a	b
1	1	1
2	2	2
3	3	3
4	4	4
delete from t1;
select count (*) from t1;
count (*)
0
drop table t1;
create table t1 (id int primary key auto_increment, num int) engine = blitzdb;
insert into t1 (num) values (1);
select * from t1;
id	num
1	1
insert into t1 (num) values (1);
insert into t1 (num) values (1);
insert into t1 (num) values (1);
select count(*) from t1;
count(*)
4
flush table t1;
select count(*) from t1;
count(*)
4
insert into t1 (num) values (1);
insert into t1 (num) values (1);
insert into t1 (num) values (1);
insert into t1 (num) values (1);
select count(*) from t1;
count(*)
8
select count(num) from t1;
count(num)
8
select * from t1;
id	num
1	1
2	1
3	1
4	1
5	1
6	1
7	1
8	1
drop table t1;
create table t1 (id int primary key auto_increment) engine = blitzdb;
insert into t1 values ();
insert into t1 values ();
insert into t1 values ();
insert into t1 values ();
select count(*) from t1;
count(*)
4
delete from t1 where id = 1;
delete from t1 where id = 2;
select count(*) from t1;
count(*)
2
insert into t1 values ();
insert into t1 values ();
select count(*) from t1;
count(*)
4
drop table t1;
create table t1 (id varchar(64) primary key, country varchar(64)) engine = blitzdb;
insert into t1 values ('amsterdam', 'netherlands');
insert into t1 values ('budapest', 'hungary');
insert into t1 values ('copenhagen', 'denmark');
insert into t1 values ('dublin', 'ireland');
insert into t1 values ('edinburgh', 'scotland');
insert into t1 values ('fukuoka', 'japan');
insert into t1 values ('geneva', 'switzerland');
select * from t1;
id	country
amsterdam	netherlands
budapest	hungary
copenhagen	denmark
dublin	ireland
edinburgh	scotland
fukuoka	japan
geneva	switzerland
select country from t1 where id = 'dublin';
country
ireland
select country from t1 where id = 'geneva';
country
switzerland
select country from t1 where id = 'amsterdam';
country
netherlands
select country from t1 where id = 'non existent key';
country
select country from t1 where id = 'edinburgh';
country
scotland
select country from t1 where id = 'copenhagen';
country
denmark
select country from t1 where id = 'fukuoka';
country
japan
select country from t1 where id = 'budapest';
country
hungary
select count (id) from t1;
count (id)
7
delete from t1 where id = 'geneva';
delete from t1 where id = 'fukuoka';
select count (id) from t1;
count (id)
5
select count (*) from t1;
count (*)
5
select * from t1;
id	country
amsterdam	netherlands
budapest	hungary
copenhagen	denmark
dublin	ireland
edinburgh	scotland
drop table t1;
create table t1 (a varchar(10) primary key, b int) engine = blitzdb;
insert into t1 values ('aaa', 1), ('bbb', 2), ('ccc', 3), ('ddd', 4);
insert into t1 values ('eee', 5), ('fff', 6), ('ggg', 7), ('hhh', 8);
select * from t1 where a = 'aaa';
a	b
aaa	1
select * from t1 where a = 'bbb';
a	b
bbb	2
select * from t1 where a = 'ccc';
a	b
ccc	3
select * from t1 where a = 'ddd';
a	b
ddd	4
select * from t1;
a	b
aaa	1
bbb	2
ccc	3
ddd	4
eee	5
fff	6
ggg	7
hhh	8
delete from t1 where a = 'ggg';
delete from t1 where a = 'hhh';
select * from t1;
a	b
aaa	1
bbb	2
ccc	3
ddd	4
eee	5
fff	6
update t1 set a = 'zzz' where a = 'fff';
select * from t1 where a = 'fff';
a	b
select * from t1 where a = 'zzz';
a	b
zzz	6
drop table t1;
create table t1 (id varchar(255) primary key, num int) engine = blitzdb;
insert into t1 values ('a', 1);
insert into t1 values ('b', 2);
insert into t1 values ('c', 3);
insert into t1 values ('d', 4);
insert into t1 values ('e', 5);
select * from t1;
id	num
a	1
b	2
c	3
d	4
e	5
update t1 set id = 'b' where id = 'a';
ERROR 23000: Duplicate entry 'b' for key 'PRIMARY'
update t1 set id = 'c' where id = 'b';
ERROR 23000: Duplicate entry 'c' for key 'PRIMARY'
update t1 set id = 'd' where id = 'c';
ERROR 23000: Duplicate entry 'd' for key 'PRIMARY'
update t1 set id = 'e' where id = 'd';
ERROR 23000: Duplicate entry 'e' for key 'PRIMARY'
update t1 set id = 'f' where id = 'a';
update t1 set id = 'g' where id = 'b';
update t1 set id = 'h' where id = 'c';
update t1 set id = 'i' where id = 'd';
update t1 set id = 'j' where id = 'e';
select * from t1;
id	num
f	1
g	2
h	3
i	4
j	5
drop table t1;
create table t1 (id double primary key, textual varchar(128)) engine = blitzdb;
insert into t1 values (1.0, 'one-zero');
insert into t1 values (1.1, 'one-one');
insert into t1 values (1.2, 'one-two');
insert into t1 values (1.3, 'one-three');
insert into t1 values (1.4, 'one-four');
select * from t1;
id	textual
1	one-zero
1.1	one-one
1.2	one-two
1.3	one-three
1.4	one-four
update t1 set id = 1.1 where id = 1.0;
ERROR 23000: Duplicate entry '1.1' for key 'PRIMARY'
update t1 set id = 1.2 where id = 1.0;
ERROR 23000: Duplicate entry '1.2' for key 'PRIMARY'
update t1 set id = 1.3 where id = 1.0;
ERROR 23000: Duplicate entry '1.3' for key 'PRIMARY'
update t1 set id = 1.4 where id = 1.0;
ERROR 23000: Duplicate entry '1.4' for key 'PRIMARY'
update t1 set id = 2.0 where id = 1.0;
update t1 set id = 2.1 where id = 1.1;
update t1 set id = 2.2 where id = 1.2;
update t1 set id = 2.3 where id = 1.3;
update t1 set id = 2.4 where id = 1.4;
select * from t1;
id	textual
2	one-zero
2.1	one-one
2.2	one-two
2.3	one-three
2.4	one-four
update t1 set id = 2.0 where id = 2.4;
ERROR 23000: Duplicate entry '2' for key 'PRIMARY'
update t1 set id = 1.0 where id = 2.0;
update t1 set id = 1.1 where id = 2.1;
select * from t1;
id	textual
1	one-zero
1.1	one-one
2.2	one-two
2.3	one-three
2.4	one-four
drop table t1;
create table t1 (a int primary key) engine = blitzdb;
insert into t1 values (1), (2), (3), (4), (5), (6);
select * from t1;
a
1
2
3
4
5
6
delete from t1;
insert into t1 values (6), (1), (5), (3), (2), (4);
select * from t1;
a
1
2
3
4
5
6
delete from t1;
drop table t1;
create table t1 (a bigint primary key) engine = blitzdb;
insert into t1 values (10), (20), (30), (40), (50), (60);
select * from t1;
a
10
20
30
40
50
60
delete from t1;
insert into t1 values (60), (10), (50), (30), (20), (40);
select * from t1;
a
10
20
30
40
50
60
delete from t1;
drop table t1;
create table t1 (a varchar(10) primary key) engine = blitzdb;
insert into t1 values ('a'), ('b'), ('c'), ('d'), ('e');
select * from t1;
a
a
b
c
d
e
delete from t1;
insert into t1 values ('c'), ('a'), ('e'), ('b'), ('d');
select * from t1;
a
a
b
c
d
e
delete from t1;
insert into t1 values ('う'), ('お'), ('い'), ('あ'), ('え');
insert into t1 values ('こ'), ('け'), ('か'), ('く'), ('き');
select * from t1;
a
あ
い
う
え
お
か
き
く
け
こ
drop table t1;
create table t1 (a varchar(255) primary key) engine = blitzdb;
insert into t1 values ('a'), ('b'), ('c'), ('d'), ('e');
select * from t1;
a
a
b
c
d
e
delete from t1;
insert into t1 values ('c'), ('a'), ('e'), ('b'), ('d');
select * from t1;
a
a
b
c
d
e
drop table t1;
