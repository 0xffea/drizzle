SET @var="CREATE SCHEMA foomine";
EXECUTE @var CONCURRENT;
select sleep(2);
sleep(2)
0
show schemas LIKE "foomine";
Database (foomine)
foomine
SET @var="DROP SCHEMA foomine";
EXECUTE @var CONCURRENT;
SET @sleep="SELECT SLEEP(3)";
EXECUTE @sleep CONCURRENT;
SELECT USER,INFO FROM DATA_DICTIONARY.PROCESSLIST;
USER	INFO
root	SELECT USER,INFO FROM DATA_DICTIONARY.PROCESSLIST
root	SELECT SLEEP(3)
EXECUTE @sleep;
SLEEP(3)
0
SET @var="EXECUTE \"SELECT SLEEP(3)\"";
EXECUTE @var CONCURRENT;
SELECT USER,INFO FROM DATA_DICTIONARY.PROCESSLIST;
USER	INFO
root	SELECT USER,INFO FROM DATA_DICTIONARY.PROCESSLIST
root	NULL
EXECUTE @sleep;
SLEEP(3)
0
SET @var="EXECUTE \"SELECT SLEEP(3)\" CONCURRENT";
EXECUTE @var CONCURRENT;
SELECT USER,INFO FROM DATA_DICTIONARY.PROCESSLIST;
USER	INFO
root	SELECT USER,INFO FROM DATA_DICTIONARY.PROCESSLIST
root	NULL
SET @var="CREATE SCHEMA d; CREATE SCHEMA e;";
EXECUTE @var CONCURRENT;
EXECUTE @sleep;
SLEEP(3)
0
show schemas LIKE "d";
Database (d)
d
show schemas LIKE "e";
Database (e)
e
DROP SCHEMA d;
DROP SCHEMA e;
CREATE TABLE foo (a serial);
SET @var="INSERT INTO foo VALUES(); INSERT INTO foo VALUES ()";
EXECUTE @var CONCURRENT;
EXECUTE @sleep;
SLEEP(3)
0
SELECT * FROM foo;
a
1
2
SET @var="SAVEPOINT mine; INSERT INTO foo VALUES(); INSERT INTO foo VALUES ()";
EXECUTE @var CONCURRENT;
EXECUTE @sleep;
SLEEP(3)
0
SELECT * FROM foo;
a
1
2
3
4
SET @var="SAVEPOINT mine; INSERT INTO foo VALUES(); INSERT INTO foo VALUES (); RELEASE SAVEPOINT mine";
EXECUTE @var CONCURRENT;
EXECUTE @sleep;
SLEEP(3)
0
SELECT * FROM foo;
a
1
2
3
4
5
6
SET @var="SAVEPOINT mine; INSERT INTO foo VALUES (); INSERT INTO foo VALUES (); ROLLBACK TO SAVEPOINT mine";
EXECUTE @var CONCURRENT;
EXECUTE @sleep;
SLEEP(3)
0
SELECT * FROM foo;
a
1
2
3
4
5
6
DROP TABLE foo;
