#
# We check that no one can create tables into some of the schemas.
#

CREATE SCHEMA admin;
CREATE SCHEMA temporary_a;

SELECT SCHEMA();

CREATE TABLE admin.t1 (A SERIAL);
DROP TABLE admin.t1;

--error ER_SYNTAX_ERROR,1064
CREATE TABLE .admin.t1 (A SERIAL);

--error ER_WRONG_DB_NAME
CREATE TABLE `.admin`.t1 (A SERIAL);

CREATE TABLE temporary_a.t1 (A SERIAL);
DROP TABLE temporary_a.t1;

--error ER_SYNTAX_ERROR,1064
CREATE TABLE .temporary_a.t1 (A SERIAL);
--error ER_WRONG_DB_NAME
CREATE TABLE `.temporary_a`.t1 (A SERIAL);

use admin;
# This will succeed because we parse the . as being the current schema.
CREATE TABLE .temporary_a (A SERIAL);
DROP TABLE .temporary_a;

--error ER_WRONG_TABLE_NAME
CREATE TABLE `.temporary_a` (A SERIAL);

CREATE TABLE `temporary_a` (A SERIAL);
DROP TABLE `temporary_a`;

CREATE TABLE `#temporary_a` (A SERIAL);
DROP TABLE `#temporary_a`;

--error 1064
CREATE TABLE #temporary_a (A SERIAL);

--error ER_WRONG_TABLE_NAME
CREATE TABLE `temporary_a ` (A SERIAL);

SELECT TABLE_NAME FROM DATA_DICTIONARY.TABLES WHERE TABLE_SCHEMA=SCHEMA();

--error ER_WRONG_TABLE_NAME,ER_WRONG_DB_NAME
CREATE TABLE aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa (A SERIAL);

--error ER_WRONG_TABLE_NAME,ER_WRONG_DB_NAME
CREATE TABLE aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa (A SERIAL);

DROP SCHEMA admin;
DROP SCHEMA temporary_a;
