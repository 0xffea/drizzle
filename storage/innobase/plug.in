DRIZZLE_STORAGE_ENGINE(innobase,  innodb, [InnoDB Storage Engine],
        [Transactional Tables using InnoDB], [max,max-no-ndb])
DRIZZLE_PLUGIN_STATIC(innobase,   [libinnobase.la])
DRIZZLE_PLUGIN_DYNAMIC(innobase,   [libinnobase.la])
DRIZZLE_PLUGIN_MANDATORY(innobase)  dnl Default
DRIZZLE_PLUGIN_ACTIONS(innobase,  [
  AC_PROG_LEX
  AC_FUNC_MMAP
  AC_CHECK_LIB(rt, aio_read, [innodb_system_libs="-lrt"])
  AC_SUBST(innodb_system_libs)
  AC_CHECK_HEADERS(aio.h sched.h)
  AC_CHECK_SIZEOF(int, 4)
  AC_CHECK_SIZEOF(long, 4)
  AC_CHECK_SIZEOF(void*, 4)
  AC_CHECK_FUNCS(sched_yield)
  AC_CHECK_FUNCS(fdatasync)
  AC_CHECK_FUNCS(localtime_r)
  AC_CHECK_FUNCS([uname munmap memchr getpagesize bzero])
  AC_C_BIGENDIAN
  case "$target_os" in
         lin*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_LINUX";;
         hpux10*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_MUST_NOT_INLINE -DUNIV_HPUX -DUNIV_HPUX10";;
         hp*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_MUST_NOT_INLINE -DUNIV_HPUX";;
         aix*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_AIX";;
         irix*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_MUST_NOT_INLINE";;
         osf*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_MUST_NOT_INLINE";;
	 *solaris*|*SunOS*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_SOLARIS";;
         sysv5uw7*)
           # Problem when linking on SCO
           AM_CFLAGS="$AM_CFLAGS -DUNIV_MUST_NOT_INLINE";;
         openbsd*)
           AM_CFLAGS="$AM_CFLAGS -DUNIV_MUST_NOT_INLINE";;
  esac

  AM_CONDITIONAL(BUILD_DRIZZLE,[test "x$ac_build_drizzle" = "xyes"])
  ])

